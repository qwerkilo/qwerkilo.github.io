<!DOCTYPE html>
<html><head>
<title>iplay20 magisk 修补boot制作教程</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">











<link type="text/css" rel="stylesheet" href="/vendor/css/bootstrap.min.css">


  






<link rel="stylesheet" href="https://qwerkilo.github.io/scss/journal.min.f4a8de07567a2d29619e0711662ef6251e3e59b642079f99490f654abf89a3c4.css" integrity="sha256-9KjeB1Z6LSlhngcRZi72JR4&#43;WbZCB5&#43;ZSQ9lSr&#43;Jo8Q=" media="screen">



<link rel="stylesheet" href="https://qwerkilo.github.io/scss/dark-mode.min.eeb8040aa9333250b7fec770f950bfe8ba9b18a5eeeaf2dfef61d84d3956f625.css" integrity="sha256-7rgECqkzMlC3/sdw&#43;VC/6LqbGKXu6vLf72HYTTlW9iU=" media="screen">


<script src="/vendor/js/loadCSS.js"></script>
<script>
  loadCSS("https://fonts.googleapis.com/css?family=Fira+Mono|Material+Icons");
</script>






  <script src="/js/toc.js"></script>













<script>console.log("Hello from 'layouts/partials/extended_head.html'")</script>

</head>
<body>
    	<div id="app"><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="https://qwerkilo.github.io">
    
        <div class="nav-title">
            辣鸡萝莉糖
        </div>
        
        <div class="nav-subtitle">
            Themed by Diary.
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="/posts">
                文章
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/categories">
                目录
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/tags">
                标签
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="/index.xml">
                RSS订阅
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	没有版权，个人随写
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    
    
    <div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }">


	<div class="toc-content">
	
		
		
		
		<center>- 目录 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%bf%85%e8%a6%81%e5%b7%a5%e5%85%b7" onclick="onNavClick(`#必要工具-nav`)" id="必要工具-nav">
									必要工具
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%94%9f%e6%88%90%e8%87%aa%e5%b7%b1%e7%9a%84vbmeta" onclick="onNavClick(`#生成自己的vbmeta-nav`)" id="生成自己的vbmeta-nav">
									生成自己的vbmeta
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%94%a8magisk%e4%bf%ae%e8%a1%a5boot" onclick="onNavClick(`#用magisk修补boot-nav`)" id="用magisk修补boot-nav">
									用magisk修补boot
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%ad%be%e5%90%8d%e4%bf%ae%e8%a1%a5%e5%a5%bd%e7%9a%84boot" onclick="onNavClick(`#签名修补好的boot-nav`)" id="签名修补好的boot-nav">
									签名修补好的boot
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%88%b7%e5%85%a5boot%e5%92%8cvbmeta" onclick="onNavClick(`#刷入boot和vbmeta-nav`)" id="刷入boot和vbmeta-nav">
									刷入boot和vbmeta
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9" onclick="onNavClick(`#注意事项-nav`)" id="注意事项-nav">
									注意事项
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
    
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top" :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div>
<div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="/posts">
                    文章
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/categories">
                    目录
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/tags">
                    标签
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="/index.xml">
                    RSS订阅
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 目录 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%bf%85%e8%a6%81%e5%b7%a5%e5%85%b7" onclick="onNavClick(`#必要工具-nav`)" id="必要工具-nav">
									必要工具
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%94%9f%e6%88%90%e8%87%aa%e5%b7%b1%e7%9a%84vbmeta" onclick="onNavClick(`#生成自己的vbmeta-nav`)" id="生成自己的vbmeta-nav">
									生成自己的vbmeta
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%94%a8magisk%e4%bf%ae%e8%a1%a5boot" onclick="onNavClick(`#用magisk修补boot-nav`)" id="用magisk修补boot-nav">
									用magisk修补boot
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e7%ad%be%e5%90%8d%e4%bf%ae%e8%a1%a5%e5%a5%bd%e7%9a%84boot" onclick="onNavClick(`#签名修补好的boot-nav`)" id="签名修补好的boot-nav">
									签名修补好的boot
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e5%88%b7%e5%85%a5boot%e5%92%8cvbmeta" onclick="onNavClick(`#刷入boot和vbmeta-nav`)" id="刷入boot和vbmeta-nav">
									刷入boot和vbmeta
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9" onclick="onNavClick(`#注意事项-nav`)" id="注意事项-nav">
									注意事项
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="https://qwerkilo.github.io">
            辣鸡萝莉糖
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="https://qwerkilo.github.io">
        <div class="single-column-header-title">辣鸡萝莉糖</div>
        
        <div class="single-column-header-subtitle">Themed by Diary.</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            
                
            

            <div class="post-head-wrapper"
                
                    
                    
                    style="background-image: url('https://cdn.jsdelivr.net/gh/qwerkilo/Image/202203061537261.jpg')"
                    
                
            >
                <div class="post-title">
                    iplay20 magisk 修补boot制作教程
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2022-03-06 15:29
                        </time>
                        

                        

                        
                            <i class="material-icons" style="">label</i>
                            
                                <a href="/tags/iplay20">iplay20</a>
                                &nbsp;
                            
                                <a href="/tags/magisk">magisk</a>
                                &nbsp;
                            
                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <p>本文参考了h论坛上的<a href="https://forum.hovatek.com/thread-32664.html">帖子</a></p>
<h2 id="必要工具">必要工具</h2>
<ul>
<li>一台装了python的linux机器（我用的debian）</li>
<li>签名文件</li>
<li>iplay20原版boot.img</li>
<li>一台已经root了的其他的设备</li>
<li>AVBtool</li>
</ul>
<p>必要文件已经上传好了下载链接在下面</p>
<pre tabindex="0"><code>https://wwi.lanzouy.com/b07hjo4uh
密码:8pvt
</code></pre><h2 id="生成自己的vbmeta">生成自己的vbmeta</h2>
<p>首先，生成自己的vbmeta，生成vbmeta用到的文件都在keys下了，当然如果需要使用自己的密钥的话可以自己生成。展讯的s9863a以及s9832e vbmeta和boot等镜像修改签名的方法是一样的。生成vbmeta的命令如下：</p>
<pre tabindex="0"><code>python avbtool make_vbmeta_image --key rsa4096_vbmeta.pem --algorithm SHA256_RSA4096 --flag 0 –padding_size 16384 --chain_partition boot:1:keys/hovatek.bin --chain_partition dtbo:10:keys/dtbo.bin --chain_partition recovery:2:keys/recovery.bin --chain_partition socko:11:keys/socko.bin --chain_partition odmko:12:keys/odmko.bin --chain_partition vbmeta_system:3:keys/vbmeta_system.bin --chain_partition vbmeta_vendor:4:keys/vbmeta_vendor.bin --chain_partition l_modem:6:keys/l_modem.bin --chain_partition l_ldsp:7:keys/l_ldsp.bin --chain_partition l_gdsp:8:keys/l_gdsp.bin --chain_partition pm_sys:9:keys/pm_sys.bin --output vbmeta-sign-custom.img
</code></pre><p>这里说明一下，命令要在linux下和<strong>keys文件夹</strong>同个目录的地方执行生成，把<strong>AVBtool</strong>也丢进这个目录。之后会生成一个属于你自己的vbmeta的img文件，名字是vbmeta-sign-custom.img。以上命令参考自酷比论坛的以下命令：</p>
<pre tabindex="0"><code>python2 avbtool make_vbmeta_image –key rsa4096_vbmeta.pem –algorithm SHA256_RSA4096 –flag 0 –padding_size 16384 \
–chain_partition boot:1:keys/x_key.bin \
–chain_partition dtbo:10:keys/key_dtbo.bin \
–chain_partition recovery:2:keys/key_recovery.bin \
–chain_partition socko:11:keys/key_socko.bin \
–chain_partition odmko:12:keys/key_odmko.bin \
–chain_partition vbmeta_system:3:keys/key_vbmeta_system.bin \
–chain_partition vbmeta_vendor:4:keys/key_vbmeta_vendor.bin \
–chain_partition l_modem:6:keys/key_l_modem.bin \
–chain_partition l_ldsp:7:keys/key_l_ldsp.bin \
–chain_partition l_gdsp:8:keys/key_l_gdsp.bin \
–chain_partition pm_sys:9:keys/key_pm_sys.bin \
–output vbmeta_my.img
</code></pre><p>其中你要修改的boot.img最后签名跟里面的x_key.bin是对应的。关于bin文件的生成命令如下，如果使用我提供的可以跳过：</p>
<pre tabindex="0"><code>python avbtool extract_public_key --key hovatek.pem --output keys/hovatek.bin
</code></pre><p>其中hovatek.pem为证书文件，你可以替换成你自己的，证书生成自行查阅资料，我用的默认<strong>rsa4096_vbmeta.pem</strong></p>
<p>紫光这soc要求vbmeta和boot要用的一样的证书才能过验证，所以很麻烦。</p>
<p>到这里为止vbmeta就搞定了，这次生成的vbmeta你可以一直以后都用下去。只要以后每次boot签名的证书和你生成vbmeta用的证书一样的就可以了。</p>
<h2 id="用magisk修补boot">用magisk修补boot</h2>
<p>这里应该可以跳过，用我提供的原版boot.img丢到已经root的设备上用magisk修补boot就行可，一般会生成一个新的修补好的boot.img。</p>
<h2 id="签名修补好的boot">签名修补好的boot</h2>
<p>使用上面生成vbmeta时候用的证书来生成boot，先把magisk修补后生成的文件丢进linux，然后执行以下命令：</p>
<pre tabindex="0"><code>python avbtool add_hash_footer --image magisk_patched-23016_BohEx.img --partition_name boot --partition_size 36700160 --key rsa4096_vbmeta.pem --algorithm SHA256_RSA4096
</code></pre><p>其中，magisk_patched-23016_BohEx.img为magisk修补后生成的文件，rsa4096_vbmeta.pem为使用的证书。如果偷懒的话其实以后每次只要把原版boot用magisk修补一下然后丢进linux执行一下上面的命令就可以刷入iplay20上用了。</p>
<h2 id="刷入boot和vbmeta">刷入boot和vbmeta</h2>
<p>这个应该大家都懂，iplay20进fastbootd，电脑执行命令：</p>
<pre tabindex="0"><code>fastboot --disable-verity --disable-verification flash vbmeta vbmeta_signed.img

fastboot flash boot boot-magisk-20.4-T1011s-20200513.img
</code></pre><p>vbmeta_signed.img和boot-magisk-20.4-T1011s-20200513.img分别为上面生成的vbmeta和已经自己签名好的boot，改一下名字刷入即可。</p>
<h2 id="注意事项">注意事项</h2>
<p>切记，因为生成的vbmeta和原厂的不一样，所以不能用升级工具的方法刷入自己生成的vbmeta和boot，会卡住的，老老实实用命令行哈。授人以鱼不如授人以渔，大家搞起来。</p>
<p>PS：目前安卓12下好像USB有问题，进系统后电脑没法用adb管理iplay20.安卓12的话推荐用LineageOS，phh的aosp总感觉卡了点。</p>
<p><a href="https://sourceforge.net/projects/andyyan-gsi/files/lineage-19.x/">下载地址</a></p>
<p>找arm64_bvS-vndklite的下就行了，刷入可以开机问题不大，记得先双清。</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">最后修改于 2022-03-06</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="https://qwerkilo.github.io/posts/a_nows7ia/">
			下回<br>关于gridea同步经常出问题的解决方法
                </a>
                
                
                
                <a class="older-posts">
			上回<br>这是最旧的文章了。
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                










            </div>
        </div>
    </div>


                    </div>
            </div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://amazingrise.net">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	没有版权，个人随写
	
</div>
            </div>
    
    <script src="/js/journal.js"></script>
    </body>
</html>
